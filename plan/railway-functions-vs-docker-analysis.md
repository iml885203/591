# Railway Functions vs Docker éƒ¨ç½²åˆ†æ

## ğŸ“Š Railway Functions ç‰¹æ€§åˆ†æ

### âœ… Railway Functions å„ªå‹¢

1. **æˆæœ¬æ•ˆç›Š**
   - æŒ‰éœ€åŸ·è¡Œï¼Œåªåœ¨é‹è¡Œæ™‚è¨ˆè²»
   - æ²’æœ‰æŒçºŒé‹è¡Œçš„åŸºç¤é–‹éŠ·
   - å¯èƒ½æ¯” 24/7 Docker å®¹å™¨æ›´ä¾¿å®œ

2. **éƒ¨ç½²ç°¡ä¾¿**
   - å–®ä¸€ TypeScript æª”æ¡ˆ
   - å…§å»ºç·¨è¼¯å™¨ç›´æ¥ä¿®æ”¹
   - ç„¡éœ€ Docker è¨­å®š

3. **è‡ªå‹•ä¾è³´ç®¡ç†**
   - è‡ªå‹•å®‰è£ NPM å¥—ä»¶
   - Bun é‹è¡Œæ™‚çš„åŸç”Ÿ API

### âŒ Railway Functions é™åˆ¶

1. **åš´é‡çš„æª”æ¡ˆé™åˆ¶**
   - **å–®ä¸€æª”æ¡ˆ**: åªèƒ½æœ‰ä¸€å€‹ .ts æª”æ¡ˆ
   - **96KB é™åˆ¶**: ç„¡æ³•å®¹ç´è¤‡é›œçˆ¬èŸ²é‚è¼¯
   - **ç„¡è³‡æ–™å¤¾çµæ§‹**: ä¸æ”¯æ´ lib/ ç›®éŒ„æ¶æ§‹

2. **æ¶æ§‹ä¸ç›¸å®¹**
   - ç¾æœ‰å¤šæª”æ¡ˆæ¶æ§‹éœ€å®Œå…¨é‡å¯«
   - ç„¡æ³•ä½¿ç”¨ç¾æœ‰çš„ domain models
   - å¤±å»ç¨‹å¼ç¢¼æ¨¡çµ„åŒ–å„ªå‹¢

## ğŸ” é‡å° 591 çˆ¬èŸ²çš„å¯è¡Œæ€§åˆ†æ

### ç¾æœ‰ç¨‹å¼ç¢¼çµæ§‹
```
lib/
â”œâ”€â”€ crawlService.js         # ä¸»è¦é‚è¼¯
â”œâ”€â”€ crawler.js              # çˆ¬èŸ²æ ¸å¿ƒ  
â”œâ”€â”€ multiStationCrawler.js  # å¤šç«™è™•ç†
â”œâ”€â”€ notification.js         # Discord é€šçŸ¥
â”œâ”€â”€ Rental.js              # è³‡æ–™æ¨¡å‹
â””â”€â”€ domain/                # é ˜åŸŸæ¨¡å‹
    â”œâ”€â”€ Distance.js
    â”œâ”€â”€ SearchUrl.js  
    â””â”€â”€ PropertyId.js
```

### Functions é™åˆ¶å½±éŸ¿

1. **ç„¡æ³•ä½¿ç”¨æ¨¡çµ„åŒ–æ¶æ§‹**
   ```typescript
   // âŒ Functions ä¸æ”¯æ´é€™æ¨£çš„ import
   import { crawlWithNotifications } from './lib/crawlService.js';
   import { SearchUrl } from './lib/domain/SearchUrl.js';
   
   // âœ… åªèƒ½å…¨éƒ¨å¯«åœ¨å–®ä¸€æª”æ¡ˆä¸­ (ä½†æœƒè¶…é 96KB)
   ```

2. **96KB é™åˆ¶åˆ†æ**
   ```bash
   # æª¢æŸ¥ç¾æœ‰æ ¸å¿ƒæª”æ¡ˆå¤§å°
   lib/crawlService.js      ~8KB
   lib/crawler.js           ~12KB  
   lib/multiStationCrawler.js ~6KB
   lib/Rental.js           ~4KB
   lib/domain/*.js         ~12KB
   lib/notification.js     ~3KB
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ç¸½è¨ˆ                    ~45KB
   ```
   
   **åŠ ä¸Š Cheerio, Puppeteer é‚è¼¯**: å¾ˆå¯èƒ½è¶…é 96KB

## ğŸ’¡ æ··åˆæ¶æ§‹å»ºè­°

### æ–¹æ¡ˆä¸€: ç´” Functions (ä¸æ¨è–¦)
```typescript
// å–®ä¸€æª”æ¡ˆåŒ…å«æ‰€æœ‰é‚è¼¯ - æœƒå¾ˆé›£ç¶­è­·
export default async function handler(request: Request) {
  // 45KB+ çš„ç¨‹å¼ç¢¼å…¨éƒ¨å¡åœ¨é€™è£¡
  // ç¶­è­·æ€§æ¥µå·®
}
```

### æ–¹æ¡ˆäºŒ: Docker + Functions æ··åˆ (æ¨è–¦)
```
Docker æœå‹™ (ä¸»è¦çˆ¬èŸ²):
â”œâ”€â”€ 24/7 API æœå‹™ (ç¾æœ‰æ¶æ§‹)
â”œâ”€â”€ å®Œæ•´çˆ¬èŸ²åŠŸèƒ½
â””â”€â”€ è³‡æ–™åº«é€£ç·š

Functions æœå‹™ (è¼”åŠ©åŠŸèƒ½):
â”œâ”€â”€ Webhook è™•ç†
â”œâ”€â”€ ç°¡å–® API ç«¯é»  
â””â”€â”€ å®šæ™‚è§¸ç™¼å™¨
```

### æ–¹æ¡ˆä¸‰: é‡æ§‹ç‚ºå¾®æœå‹™ Functions
```
Function 1: è³‡æ–™ç²å– (çˆ¬èŸ²æ ¸å¿ƒ)
Function 2: è³‡æ–™è™•ç† (è§£æå’Œæ¯”å°)  
Function 3: é€šçŸ¥ç™¼é€ (Discord)
Function 4: è³‡æ–™æŸ¥è©¢ API
```

## ğŸ“Š æˆæœ¬æ¯”è¼ƒåˆ†æ

### Docker 24/7 é‹è¡Œ
```
å„ªé»: 
âœ… å®Œæ•´åŠŸèƒ½
âœ… å³æ™‚éŸ¿æ‡‰
âœ… è¤‡é›œé‚è¼¯æ”¯æ´

æˆæœ¬:
- $5/æœˆå…è²»é¡åº¦ (ç´„500å°æ™‚)
- è¶…éå¾ŒæŒ‰å°æ™‚è¨ˆè²»
```

### Functions æŒ‰éœ€åŸ·è¡Œ
```
å„ªé»:
âœ… æŒ‰éœ€è¨ˆè²»
âœ… è‡ªå‹•æ“´å±•
âœ… ç„¡åŸºç¤è¨­æ–½ç¶­è­·

é™åˆ¶:
âŒ å–®æª”æ¡ˆ 96KB é™åˆ¶
âŒ å†·å•Ÿå‹•å»¶é²
âŒ æ¶æ§‹éœ€é‡å¯«
```

## ğŸ¯ å¯¦éš›å»ºè­°

### æ¨è–¦æ–¹æ¡ˆ: Docker ç‚ºä¸»

**ç†ç”±:**
1. **ç¾æœ‰æ¶æ§‹å®Œç¾åŒ¹é…** - é›¶ä¿®æ”¹å³å¯éƒ¨ç½²
2. **åŠŸèƒ½å®Œæ•´æ€§** - æ”¯æ´æ‰€æœ‰è¤‡é›œé‚è¼¯
3. **é–‹ç™¼æ•ˆç‡** - ç„¡éœ€é‡å¯« 45KB+ ç¨‹å¼ç¢¼
4. **ç¶­è­·æ€§** - ä¿æŒæ¨¡çµ„åŒ–æ¶æ§‹

### æˆæœ¬å„ªåŒ–ç­–ç•¥

```typescript
// åœ¨ Docker ä¸­å¯¦ç¾æ™ºèƒ½ä¼‘çœ 
const IDLE_TIMEOUT = 30 * 60 * 1000; // 30åˆ†é˜

let lastActivity = Date.now();
setInterval(() => {
  if (Date.now() - lastActivity > IDLE_TIMEOUT) {
    // é€²å…¥ä½è³‡æºæ¨¡å¼
    process.exit(0); // Railway æœƒè‡ªå‹•é‡å•Ÿ
  }
}, 60000);
```

### å°å‹ Functions è£œå¼·

```typescript
// webhook-handler.ts (å¯ç”¨ Functions)
export default async function handler(req: Request) {
  // è§¸ç™¼ä¸»è¦ Docker æœå‹™
  await fetch('https://your-crawler.railway.app/api/crawl', {
    method: 'POST',
    body: JSON.stringify(await req.json())
  });
  
  return new Response('OK', { status: 200 });
}
```

## ğŸš€ æœ€çµ‚å»ºè­°

**å …æŒä½¿ç”¨ Docker éƒ¨ç½²**

1. **ç«‹å³å¯ç”¨** - ç¾æœ‰ç¨‹å¼ç¢¼ç›´æ¥éƒ¨ç½²
2. **åŠŸèƒ½å®Œæ•´** - ä¸å— Functions é™åˆ¶
3. **æ¶æ§‹å„ªé›…** - ä¿æŒ domain-driven è¨­è¨ˆ
4. **æœªä¾†å½ˆæ€§** - å®¹æ˜“æ“´å±•åŠŸèƒ½

**Functions ä½œç‚ºè£œå……:**
- Webhook è™•ç†
- ç°¡å–® API ä»£ç†
- å®šæ™‚è§¸ç™¼å™¨

é€™æ¨£æ—¢ä¿æŒæ¶æ§‹å„ªé›…ï¼Œåˆèƒ½æ§åˆ¶æˆæœ¬ï¼